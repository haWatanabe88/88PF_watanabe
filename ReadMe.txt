RavenousBladeが制作したコードです
oldは数年前に制作したものです。